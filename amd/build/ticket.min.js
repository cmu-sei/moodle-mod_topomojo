define("mod_topomojo/ticket",["jquery","core/config","core/log"],(function($,config,log){var eventId;return{init:function(info){eventId=info.id;var consoleButtons=document.getElementsByClassName("console");consoleButtons&&consoleButtons.forEach((function(button){button.onclick=function(){$.ajax({url:config.wwwroot+"/mod/topomojo/getticket.php",type:"POST",data:{sesskey:config.sesskey,id:eventId},headers:{"Cache-Control":"no-cache",Expires:"-1"},success:function(result){var urlWithTicket,ticket=result.ticket,baseUrl=button.id;urlWithTicket=-1!==baseUrl.indexOf("/mks/")?baseUrl+"&t="+encodeURIComponent(ticket):baseUrl+"&token="+encodeURIComponent(ticket),window.open(urlWithTicket,"_blank")},error:function(request){log.debug("moodle-mod_topomojo-generate_ticket: "+request)}})}}))}}}));

//# sourceMappingURL=ticket.min.js.map